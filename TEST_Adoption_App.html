<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adoption Form</title>

    <style>
      body {
        font-family: Oswald, sans-serif;
        margin: 20px;
        line-height: 1.6;
      }

      /* replaces tabs */
      .tab-buttons {
        display: flex;
        cursor: pointer;
        margin-bottom: 10px;
        /* max-width: 1000px; */
      }
      .tab-buttons button {
        /* margin-right: 5px; */
        /* padding: 10px 15px; */
        cursor: pointer;
        background-color: white;
        color: #e85b93;
        border: none;
        font-size: 16px;
      }
      .tab-buttons button.active {
        background-color: white;
        color: #e85b93;
        border: none;
        font-weight: 1000;
      }
      .tab-buttons button:hover {
        background-color: white;
        color: #ec7ba8;
        border: none;
      }

      /* replaces tab content */
      .tab {
        display: none;
      }
      .tab.active {
        display: block;
      }

      form {
        max-width: 600px;
        margin: auto;
      }

      .form-row {
        display: flex;
        gap: 30px;
        justify-content: center;
      }

      .form-row div {
        flex: 1;
        width: 100%;
      }

      .error {
        border: 2px solid red;
      }
      .error-message {
        color: red;
        font-size: 0.9em;
      }

      /* Remove red border box for checkbox validation */
      input[type="checkbox"] + label {
        border: none;
      }

      [data-required="required"].error {
        border: none;
      }

      /* Style the error message for checkboxes */
      [data-required="required"] + .error-message {
        color: red;
        font-size: 0.9em;
      }

      .required {
        color: red;
        font-weight: bold;
      }

      h3 {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }

      input, select, textarea, button {
        width: 100%;
        padding: 8px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 4px;
      }

      button {
        background-color: #e85b93;
        color: white;
        cursor: pointer;
      }

      button:hover {
        background-color: #ec7ba8;
      }

      .alignment {
        display: flex;
        flex-direction: row;
        align-items: baseline;
      }

      .alignment input {
        margin-top: 15px;
        width: 5%;
      }

      .alignment label {
        width: 100%;
      }

      .navigation-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        position: relative;
      }

      .navigation-buttons .prev {
        align-self: flex-start;
        visibility: hidden;
        width: auto;
        margin-right: auto;
      }

      .navigation-buttons .next,
      .navigation-buttons .submit {
        align-self: flex-end;
        width: auto;
      }

      input[type="submit"] {
        background-color: #e85b93;
        color: white;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        cursor: pointer;
        border-radius: 5px;
      }
      
    </style>

</head>
<body>
  <h1>Adoption Form</h1>

  

  <form id="adoption_form" method="POST" action="https://us09d.sheltermanager.com/service" accept-charset="utf-8" onsubmit="updateSpeciesList()">
    <!-- Tab Navigation -->
    <div class="tab-buttons">
      <button type="button" class="tab-btn active" data-tab="1">Applicant</button>
      <button type="button" class="tab-btn" data-tab="2">Environment</button>
      <button type="button" class="tab-btn" data-tab="3">Ownership</button>
      <button type="button" class="tab-btn" data-tab="4">Administrative</button>
      <button type="button" class="tab-btn" data-tab="5">Tab 5</button>
    </div>
    <!-- User Input Fields -->
    <div id="tab-1" class="tab active">
      <div class="form-row">
        <div class="form-field">
            <h3 for="f251">First Name <span class="required">*</span></h3>
            <input type="Text" id="f251" name="firstname_251" required>
            <div class="error-message"></div>
        </div>
        <div class="form-field">
            <h3 for="f281">Last Name <span class="required">*</span></h3>
            <input type="Text" id="f281" name="lastname_281" required>
            <div class="error-message"></div>
        </div>
      </div>

      <div class="form-field">
        <h3 for="f284">Email <span class="required">*</span></h3>
        <input type="email" id="f284" name="emailaddress_284" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f286">Phone <span class="required">*</span></h3>
        <input type="number" id="f286" name="mobiletelephone_286" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f287">If applicable, please provide your Instagram handle:</h3>
        <input type="text" id="f287" name="instagramhandle_287"></input>
      </div>

      <div class="form-field">
        <h3 for="f288">Address <span class="required">*</span></h3>
        <input type="text" id="f288" name="address_288" required></input>
        <div class="error-message"></div>
      </div>

      <div class="form-row">
        <div class="form-field">
          <h3 for="f289">City <span class="required">*</span></h3>
          <input type="text" id="f289" name="city_289" required>
          <div class="error-message"></div>
        </div>
        <div class="form-field">
          <h3 for="f290">State <span class="required">*</span></h3>
          <select id="f290" name="state_290" required>
            <option value="" disabled selected>Select a state...</option>
          </select>
          <div class="error-message"></div>
        </div>
        <div class="form-field">
          <h3 for="f291">ZIP Code <span class="required">*</span></h3>
          <input type="number" id="f291" name="zipcode_291" required>
          <div class="error-message"></div>
        </div>
      </div>

      <div class="form-field">
        <h3 for="f292">Applicant's Age <span class="required">*</span></h3>
        <input type="number" id="f292" name="age_292" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f293">Applicant's Occupation <span class="required">*</span></h3>
        <input type="text" id="f293" name="occupation_293" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f294">Applicant's Employer <span class="required">*</span></h3>
        <input type="text" id="f294" name="employer_294" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f295">Have you adopted an animal from our program before? <span class="required">*</span></h3>
        <select id="f295" name="repeatadopter_295" required="required">
          <option value="" disabled selected>Select an option...</option>
          <option>Yes</option>
          <option>No</option>
        </select>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f296">If you have adopted from us before, what was their name in our program? </h3>
        <input type="text" id="f296" name="adoptedpet_296">
      </div>

      <div class="form-field">
        <h3 for="f282">Select the animal you want to adopt: <span class="required">*</span></h3>
        <select type="Adoptable Animal" id="f282" name="animalname_282" required>
          <option value="">Select an animal...</option>
        </select>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f326">What made this pet stand out? <span class="required">*</span></h3>
        <input type="text" id="f326" name="standout_326" required>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f297">How did you find out about this pet? <span class="required">*</span></h3>
        <div id="f297" name="petdiscovery_297" required></div>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f298">What type of animal are you interested in adopting? <span class="required">*</span></h3>
        <div id="f298" data-name="species_298" data-required="required"></div>
        <div class="error-message"></div>
      </div>

      <div class="form-field">
        <h3 for="f299"> PLEASE NOTE: <span class="required">*</h3>
        <div style="margin: 0%;">
          Yes, we offer transport anywhere in the United States by ground or plane. We are happy to help coach our families through the transport process, but unfortunately, these fees cannot be waived or reduced as they are set by third parties. Transportation is $200 for one dog, or $150 each for multiple dogs.
        </div>
        <div class="alignment">
          <input type="radio" id="f299_0" name="transporttype_299" value="Yes! I understand interstate transport adds $200 onto the adoption cost." required>
          <label style="font-weight: bold;" for="f299_0">Yes! I understand interstate transport adds $200 onto the adoption cost.</label>
        </div>
        <div class="alignment">
          <input type="radio" id="f299_1" name="transporttype_299" value="I will come get my baby, so these services will not be needed.">
          <label style="font-weight: bold;" for="f299_1">I will come get my baby, so these services will not be needed.</label>
        </div>
        <div class="error-message"></div>
      </div>


      <div class="navigation-buttons">
        <button type="button" class="prev">Previous</button>
        <button type="button" class="next">Next</button>
      </div>
    </div>


    <!-- TAB 2: Home Environment -->
    <div id="tab-2" class="tab">
      <!-- Form Fields for Home Environment -->
      <!-- <h3 for="f300">My home is usually...</h3>
      <div class="alignment">
        <input type="radio" id="transport-yes" name="transport" value="Yes! I understand interstate transport adds $200 onto the adoption cost." required>
        <label for="transport-yes">Yes! I understand interstate transport adds $200 onto the adoption cost.</label>
      </div>
      
      <div class="alignment">
        <input type="radio" id="transport-no" name="transport" value="I will come get my baby, so these services will not be needed.">
        <label for="transport-no">I will come get my baby, so these services will not be needed.</label>
      </div> -->
      <div class="navigation-buttons">
        <button type="button" class="prev">Previous</button>
        <button type="button" class="next">Next</button>
      </div>
    </div>


    <!-- TAB 3: Pet Ownership -->
    <div id="tab-3" class="tab">
      <!-- Form Fields for Pet Ownership -->
      <!-- Add other form fields here -->
      <div class="navigation-buttons">
        <button type="button" class="prev">Previous</button>
        <button type="button" class="next">Next</button>
      </div>
    </div>


    <!-- TAB 4: Administrative -->
    <div id="tab-4" class="tab">
      <!-- Form Fields for Administrative -->
      <!-- Add other form fields here -->
      <div class="navigation-buttons">
        <button type="button" class="prev">Previous</button>
        <button type="button" class="next">Next</button>
      </div>
    </div>

    
    <!-- TAB: 5 Submit -->
    <div id="tab-5" class="tab">
      <div id="form-message" class="error"></div>
      <div class="navigation-buttons">
        <button type="button" class="prev">Previous</button>
        <button type="submit" class="submit">Submit</button>
      </div>
    </div>


    <!-- Hidden Fields -->
    <input type="hidden" name="method" value="online_form_post">
    <input type="hidden" name="account" value="lwha">
    <input type="hidden" name="redirect" value="">
    <input type="hidden" name="retainfor" value="0">
    <input type="hidden" name="flags" value="Adoption Applicant">
    <input type="hidden" name="formname" value="AMBER TEST 2">
    <input type="hidden" id="species_list" name="species_298" value="" />
            
  </form>

  
  <script>

    // List of ways to discover pet
    function updateSpeciesList() {
    // Collect the selected checkboxes
    var selectedSpecies = [];
    var checkboxes = document.querySelectorAll('#f298 input[type="checkbox"]:checked');
    checkboxes.forEach(function(checkbox) {
      selectedSpecies.push(checkbox.value);
    });

    // Join the selected species into a single string
    var speciesList = selectedSpecies.join(', ');

    // Set the joined species list into the hidden input field
    document.getElementById('species_list').value = speciesList;
    }

    
    // Tab Navigation Logic
    const tabs = document.querySelectorAll('.tab');
    const tabButtons = document.querySelectorAll('.tab-btn');
    const form = document.getElementById('adoption_form');

    function showTab(tabIndex) {
        tabs.forEach((tab, index) => {
            tab.classList.toggle('active', index === tabIndex);
        });
        tabButtons.forEach((btn, index) => {
            btn.classList.toggle('active', index === tabIndex);
        });
    }


    function validateTab(tabIndex) {
      const tab = tabs[tabIndex];
      const requiredInputs = tab.querySelectorAll('input[required], select[required]');
      let valid = true;

      // Validate text inputs, email inputs, number inputs, and select elements
      requiredInputs.forEach(input => {
        const errorMessage = input.nextElementSibling;

        if (input.type === "text" || input.tagName === "SELECT") {
          if (!input.value.trim()) {
            input.classList.add('error');
            errorMessage.textContent = 'This field is required';
            valid = false;
          } else {
            input.classList.remove('error');
            errorMessage.textContent = '';
          }
        }

        // Validate email inputs
        if (input.type === "email") {
          if (!input.value.trim() || !input.checkValidity()) {
            input.classList.add('error');
            errorMessage.textContent = 'This field is required';
            valid = false;
          } else {
            input.classList.remove('error');
            errorMessage.textContent = '';
          }
        }

        // Validate number inputs (e.g., phone, ZIP Code, age)
        if (input.type === "number") {
          if (!input.value.trim() || isNaN(input.value)) {
            input.classList.add('error');
            errorMessage.textContent = 'This field is required';
            valid = false;
          } else {
            input.classList.remove('error');
            errorMessage.textContent = '';
          }
        }
      });

      // Validate checkbox groups
      const checkboxGroups = tab.querySelectorAll('[data-required="required"]');
      checkboxGroups.forEach(group => {
        const checkboxes = group.querySelectorAll('input[type="checkbox"]');
        const errorMessage = group.nextElementSibling;

        const isChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);

        if (!isChecked) {
          errorMessage.textContent = 'Please select at least one option';
          group.classList.add('error');
          valid = false;
        } else {
          errorMessage.textContent = '';
          group.classList.remove('error');
        }
      });


      // Validate radio button groups
      const radioGroups = tab.querySelectorAll('input[type="radio"][required]');
      const radioNames = new Set();

      radioGroups.forEach(radio => {
        radioNames.add(radio.name);
      });

      radioNames.forEach(name => {
        const radios = tab.querySelectorAll(`input[name="${name}"]`);
        const errorMessage = radios[0].closest('.form-field')?.querySelector('.error-message');

        const isChecked = Array.from(radios).some(radio => radio.checked);

        if (!isChecked) {
          radios.forEach(radio => radio.classList.add('error'));
          if (errorMessage) errorMessage.textContent = 'Please select an option';
          valid = false;
        } else {
          radios.forEach(radio => radio.classList.remove('error'));
          if (errorMessage) errorMessage.textContent = '';
        }
      });

      return valid;
    }



    tabButtons.forEach((button, index) => {
        button.addEventListener('click', () => {
            if (index === tabs.length - 1) { // Submit tab
                for (let i = 0; i < tabs.length - 1; i++) {
                    if (!validateTab(i)) {
                        showTab(i);
                        return;
                    }
                }
            }
            showTab(index);
        });
    });

    form.addEventListener('submit', (event) => {
        let allValid = true;

        for (let i = 0; i < tabs.length - 1; i++) {
            if (!validateTab(i)) {
                showTab(i);
                allValid = false;
                break;
            }
        }

        if (!allValid) {
            event.preventDefault();
        }
    });



    // List of U.S. States
    const states = [
      "Texas", "Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado", "Connecticut", 
      "Delaware", "Florida", "Georgia", "Hawaii", "Idaho", "Illinois", "Indiana", "Iowa", "Kansas", 
      "Kentucky", "Louisiana", "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota", 
      "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada", "New Hampshire", "New Jersey", 
      "New Mexico", "New York", "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon", 
      "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota", "Utah", "Vermont", "Virginia", 
      "Washington", "West Virginia", "Wisconsin", "Wyoming", "Washington DC", "ARMED FORCES AFRICA", 
      "CANADA", "EUROPE", "MIDDLE EAST", "ARMED FORCES AMERICA (EXCEPT CANADA)", "ARMED FORCES PACIFIC"
    ];
    const state_element = document.getElementById('f290');
    // Generate the state options
    states.forEach(state => {
      const option = document.createElement('option');
      option.value = state;
      option.textContent = state;
      state_element.appendChild(option);
    });


    // Sample Animal Data Fetch
    async function populateDropdown() {
      const url = "https://us09d.sheltermanager.com/service?method=animal_view_adoptable_js&account=dm1425";
      const dropdown = document.getElementById("f282");

      try {
        const response = await fetch(url);
        if (!response.ok) throw new Error("Failed to fetch animal data.");

        const text = await response.text();
        const match = text.match(/var adoptables = (\[.*?\]);/s);
        if (match) {
          const animals = JSON.parse(match[1]);
          dropdown.innerHTML = "<option value=''>Select an animal...</option>";
          animals.forEach(animal => {
            const option = document.createElement("option");
            option.value = animal.ANIMALNAME;
            option.textContent = animal.ANIMALNAME || "Unknown";
            dropdown.appendChild(option);
          });
        } else {
          throw new Error("Could not parse animal data.");
        }
      } catch (error) {
        console.error(error);
        dropdown.innerHTML = "<option value=''>No animals available</option>";
      }
    }
    // Initialize Dropdown
    window.onload = populateDropdown;

    
    // List of ways to discover pet
    const pet_discovery = [
      { id: "f297_0", value: "News: KBTX" },
      { id: "f297_1", value: "Radio: Zone 1150" },
      { id: "f297_2", value: "Radio: Candy95" },
      { id: "f297_3", value: "Radio: WTAW 1620" },
      { id: "f297_4", value: "Radio: Maverick 100.9" },
      { id: "f297_5", value: "Radio: Peace 107.7" },
      { id: "f297_6", value: "Petfinder/Adoptapet" },
      { id: "f297_7", value: "Google" },
      { id: "f297_8", value: "Social Media: Facebook" },
      { id: "f297_9", value: "Social Media: Instagram" },
      { id: "f297_10", value: "Social Media: TikTok" },
      { id: "f297_11", value: "Social Media: LinkedIn" },
      { id: "f297_12", value: "Community Event" },
      { id: "f297_13", value: "Word of Mouth" },
      { id: "f297_14", value: "Other" }
    ];
    const pet_discovery_element = document.getElementById("f297");
    // Generate the discovery options
    pet_discovery.forEach(option => {
      const div = document.createElement("div");
      div.classList.add("alignment");

      const input = document.createElement("input");
      input.type = "radio";
      input.id = option.id;
      input.name = "petdiscovery_297";
      input.value = option.value;
      input.required = true;

      const label = document.createElement("label");
      label.setAttribute("for", option.id);
      label.textContent = option.value;

      div.appendChild(input);
      div.appendChild(label);
      pet_discovery_element.appendChild(div);
    });

    
    // List of pet species options
    const speciesOptions = [
      { id: "f298_0", value: "Puppy" },
      { id: "f298_1", value: "Adult dog" },
      { id: "f298_2", value: "Senior dog" },
      { id: "f298_3", value: "Kitten" },
      { id: "f298_4", value: "Adult cat" },
      { id: "f298_5", value: "Senior cat" },
      { id: "f298_6", value: "Livestock" },
      { id: "f298_7", value: "Pocket pet" }
    ];

    const speciesContainer = document.getElementById("f298");

    // Generate the checkboxes dynamically
    speciesOptions.forEach(option => {
      const div = document.createElement("div");
      div.classList.add("alignment");

      const input = document.createElement("input");
      input.type = "checkbox";
      input.id = option.id;
      input.value = option.value;
      input.addEventListener("change", updateSpeciesList); // Attach event listener to update the hidden field

      const label = document.createElement("label");
      label.setAttribute("for", option.id);
      label.textContent = option.value;

      div.appendChild(input);
      div.appendChild(label);
      speciesContainer.appendChild(div);
    });

    // Function to update the hidden input with selected checkboxes
    function updateSpeciesList() {
      const selectedSpecies = [];
      const checkboxes = document.querySelectorAll('#f298 input[type="checkbox"]:checked');
      checkboxes.forEach(checkbox => {
        selectedSpecies.push(checkbox.value);
      });

      // Join the selected species into a single string
      document.getElementById('species_list').value = selectedSpecies.join(', ');
    }


  </script>
</body>
</html>
